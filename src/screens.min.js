var GameScreen=function(){function e(){g.text=Globals.commaUpScore(r),u.text=String(i),p.text=Globals.commaUpScore(n);for(var e=1;e<=v.length;e++)e<=c?v[e-1].alpha=1:v[e-1].alpha=.3;w.gotoAndStop("iconWeapon_"+d),l===-1?f.text="@":f.text=String(l)}var t=Globals.stage,a=Globals.assetManager,r=0,i=0,n=0,s=0,o=!1,c=0,l=0,d="",h=new createjs.Container,g=new createjs.BitmapText("0",a.getSpriteSheet("charset80"));g.letterSpacing=4,g.x=7,h.addChild(g);var p=new createjs.BitmapText("0",a.getSpriteSheet("charset30"));p.letterSpacing=2,p.x=15,p.y=94,h.addChild(p);var S=a.getSprite("ui","iconLives");S.x=20,S.y=139,h.addChild(S);var u=new createjs.BitmapText("0",a.getSpriteSheet("charset30"));u.x=70,u.y=131,h.addChild(u);var C=new createjs.BitmapText("A",a.getSpriteSheet("charset30"));C.x=15,C.y=245,C.lineHeight=40,C.alpha=0,h.addChild(C);for(var v=[],x=0;x<Globals.gameConstants.PLAYER_MAX_POWER;x++){var m=a.getSprite("ui","iconPower");m.x=18+18*x,m.y=174,h.addChild(m),v.push(m)}var f=new createjs.BitmapText("0",a.getSpriteSheet("charset30"));f.letterSpacing=2,f.x=50,f.y=190,h.addChild(f);var w=a.getSprite("assets","iconSingle");w.x=18,w.y=196,h.addChild(w),this.getScore=function(){return r},this.setLevelName=function(e,t){o?(this.adjustPoints(Globals.gameConstants.PERFECT_SCORE_POINTS),createjs.Sound.play("perfectScore"),C.text="Perfect Score! +"+Globals.gameConstants.PERFECT_SCORE_POINTS+"\nLevel "+e+"\n"+t):C.text="Level "+e+"\n"+t,o=!0,createjs.Tween.get(C,{useTicks:!0}).to({alpha:1},20).call(function(){createjs.Tween.get(C,{useTicks:!0}).to({x:C.x},60).call(function(){createjs.Tween.get(C,{useTicks:!0}).to({alpha:0},20)})})},this.setHighScore=function(t){n=t,e()},this.showMe=function(){r=0,s=n,o=!1,i=Globals.gameConstants.PLAYER_START_LIVES,c=Globals.gameConstants.PLAYER_START_POWER,e(),t.addChild(h)},this.hideMe=function(){t.removeChild(h)},this.setLives=function(t){i=t,e()},this.adjustPoints=function(t){r+=t,r<0&&(r=0),t<0&&(o=!1),n=r>=s?r:s,e()},this.setPower=function(t){c=t,e()},this.setAmmo=function(t,a){l=t,d=a,e()}},HighScoreScreen=function(){function e(e){e.x=i.canvas.width/2-e.getBounds().width/2}function t(e){var t=e.split(""),a=t.reverse(),r=a.join("");return r}function a(e){"t"===e.responseText?(i.removeChild(g),i.addChild(s),createjs.Sound.play("powerupAppear")):(r.target=null,i.dispatchEvent(r))}var r=new createjs.Event("gameEvent",!0);r.id="highScoreComplete";var i=Globals.stage,n=Globals.assetManager,s=new createjs.Container,o=n.getSprite("ui","highscoreScreen");s.addChild(o);var c=n.getSprite("ui","selector");c.x=102,c.y=344,s.addChild(c);var l=new createjs.BitmapText("",n.getSpriteSheet("charset80"));l.letterSpacing=4,l.y=200,s.addChild(l);var d=new createjs.BitmapText("",n.getSpriteSheet("charset80"));d.letterSpacing=8,d.y=585,s.addChild(d);var h=n.getSprite("ui","recordingScore"),g=n.getSprite("ui","checkingScore"),p=[["A","B","C","D","E","F","G","H","I","J","K"],["L","M","N","O","P","Q","R","S","T","U","V"],["W","X","Y","Z","","","","","","-1","1"]],S=0,u=0,C=0;this.showMe=function(r){C=r,S=0,u=0,c.x=102,c.y=344,d.text="",l.text=Globals.commaUpScore(String(C)),e(l),i.addChild(g);var n=Globals.gameConstants.HIGHSCORE_SCRIPT3+"?v="+btoa(t(String(C)));Globals.sendMe(n,a)},this.hideMe=function(){i.removeChild(h),i.removeChild(g),i.removeChild(s)},this.moveSelector=function(e){switch(e){case"right":c.x+=60,u++,u>10&&(c.x=102,u=0),""===p[S][u]&&(c.x+=300,u+=5);break;case"left":c.x-=60,u--,u<0&&(c.x=702,u=10),""===p[S][u]&&(c.x-=300,u-=5);break;case"up":c.y-=70,S--,S<0&&(c.y=484,S=2),""===p[S][u]&&(c.y-=70,S=1);break;case"down":c.y+=70,S++,(S>2||""===p[S][u])&&(c.y=344,S=0)}createjs.Sound.play("interface1")},this.selectInitial=function(){var a=p[S][u],r=d.text;if("1"==a&&r.length<3)return void createjs.Sound.play("interface2");if("1"===a){i.addChild(h),i.removeChild(s);var n=CryptoJS.MD5(r+C+"2f6d0f62dbedda976330f88add53a7e7").toString();Globals.gameConstants.HIGHSCORE_SCRIPT1+"?z="+btoa(t(r))+"&a="+btoa(t(String(C)))+"&s="+n;createjs.Sound.play("powerupPickup")}else"-1"===a&&r.length>0?(d.text=r.substring(0,r.length-1),""!==d.text&&e(d),createjs.Sound.play("interface2")):"-1"!==a&&r.length<3&&(d.text+=a,e(d),createjs.Sound.play("interface3"))}},IntroScreen=function(){function e(e){for(var r=e.responseText.split(","),i=0,s=0;s<10;s+=2)u[i].text=String(i+1),C[i].text=r[s],S[i].text=Globals.commaUpScore(r[s+1]),i++;n.removeChild(c),n.addChild(h),t.target=null,t.score=r[1],a.dispatchEvent(t)}var t=new createjs.Event("gameEvent",!0);t.id="newHighScore",t.score=0;var a=Globals.stage,r=Globals.assetManager,i=(Globals.gamepad,Globals.gameConstants.HIGHSCORE_SCRIPT2),n=new createjs.Container,s=r.getSprite("ui","introScreen");n.addChild(s);var o=r.getSprite("ui","spacebar");o.x=245,o.y=600,n.addChild(o);var c=new createjs.Container;c.x=255,c.y=390;var l=r.getSprite("ui","loadingScores");l.x=70,l.y=28,c.addChild(l);var d=r.getSprite("assets","square");d.x=40,d.y=40,c.addChild(d),createjs.Tween.get(d,{useTicks:!0,loop:!0}).to({rotation:359},90);var h=new createjs.Container;h.x=248,h.y=318;var g=r.getSprite("ui","icons");h.addChild(g);for(var p=0,S=[],u=[],C=[],v=0;v<5;v++)u[v]=new createjs.BitmapText("",r.getSpriteSheet("charset30")),u[v].letterSpacing=2,u[v].scaleX=.75,u[v].scaleY=.75,u[v].x=60,u[v].y=p,h.addChild(u[v]),C[v]=new createjs.BitmapText("",r.getSpriteSheet("charset30")),C[v].letterSpacing=2,C[v].scaleX=.75,C[v].scaleY=.75,C[v].x=110,C[v].y=p,h.addChild(C[v]),S[v]=new createjs.BitmapText("",r.getSpriteSheet("charset30")),S[v].letterSpacing=2,S[v].scaleX=.75,S[v].scaleY=.75,S[v].x=200,S[v].y=p,h.addChild(S[v]),p+=52;this.showMe=function(){n.removeChild(h),n.addChild(c),Globals.sendMe(i,e),o.gotoAndStop("spacebar"),Globals.gamepadManager.connected&&o.gotoAndStop("startButton"),a.addChild(n)},this.hideMe=function(){a.removeChild(n)}},LoadScreen=function(){var e=Globals.stage,t=Globals.assetManager,a=new createjs.Container,r=t.getSprite("ui","loadScreen");a.addChild(r);var i=new createjs.Shape;i.alpha=.3,i.graphics.beginFill("#FFFFFF").drawRect(315,425,178,10),a.addChild(i),progressBar=new createjs.Shape,progressBar.graphics.beginFill("#FFFFFF").drawRect(315,425,0,10),a.addChild(progressBar),this.showMe=function(){e.addChild(a)},this.hideMe=function(){e.removeChild(a)},this.updateProgress=function(){progressBar.graphics.clear(),progressBar.graphics.beginFill("#FFFFFF").drawRect(315,425,178*t.getProgress(),10),e.update()}};